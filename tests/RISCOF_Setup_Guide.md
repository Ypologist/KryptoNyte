

> # RISC-V Conformance (RISCOF) Setup Guide for KryptoNyte
> 
> **Author:** Manus AI
> 
> **Date:** September 29, 2025
> 
> ## 1. Introduction
> 
> This document provides a comprehensive guide to setting up and using the RISC-V Conformance (RISCOF) test infrastructure for the KryptoNyte project's ZeroNyte core. The infrastructure has been updated to use RISCOF version 1.25.3 and features a reorganized directory structure for clarity and ease of use. This guide covers the directory layout, usage of the main scripts, and instructions for extending the test suites.
> 


## 2. Directory Structure

The test infrastructure is organized as follows:

| Path                      | Description                                                                 |
| ------------------------- | --------------------------------------------------------------------------- |
| `tests/riscof/`           | Contains the RISCOF plugins for ZeroNyte and Spike, and the main `config.ini`. |
| `tests/riscof/zeronyte/`  | The ZeroNyte DUT plugin for RISCOF.                                         |
| `tests/riscof/spike/`     | The Spike reference model plugin for RISCOF.                                |
| `tests/riscof_work/`      | The main working directory for all RISCOF-related files.                    |
| `tests/riscof_work/test_list.yaml` | The list of tests to be run. This file is generated by the test scripts.    |
| `tests/riscof_work/reference_signatures/` | Contains the reference signatures generated by Spike.                       |



## 3. Usage

There are two main scripts for interacting with the RISCOF infrastructure:

### 3.1. `generate_reference_signatures_fixed.sh`

This script is used to generate reference signatures using the Spike simulator. These signatures are used as the ground truth for the conformance tests.

**Usage:**

```bash
./generate_reference_signatures_fixed.sh [options]
```

**Options:**

| Option         | Description                                      |
| -------------- | ------------------------------------------------ |
| `--i`          | Generate I extension reference signatures.       |
| `--m`          | Generate M extension reference signatures.       |
| `--privilege`  | Generate privilege reference signatures.         |
| `--all`        | Generate all reference signatures (default).     |
| `--help`       | Show the help message.                           |

**Example:**

To generate all reference signatures:

```bash
./generate_reference_signatures_fixed.sh --all
```

### 3.2. `run_rtl_conformance_fixed.sh`

This script runs the conformance tests against the ZeroNyte RTL implementation.

**Usage:**

```bash
./run_rtl_conformance_fixed.sh [options]
```

**Options:**

| Option             | Description                                      |
| ------------------ | ------------------------------------------------ |
| `--with-m`         | Include M extension tests.                       |
| `--with-privilege` | Include privilege tests.                         |
| `--all`            | Include all test suites.                         |
| `--smoke-test`     | Run only a single test as a smoke test.          |
| `--help`           | Show the help message.                           |

**Example:**

To run a smoke test for the base integer instruction set:

```bash
./run_rtl_conformance_fixed.sh --smoke-test
```

To run all tests for the I and M extensions:

```bash
./run_rtl_conformance_fixed.sh --with-m
```




## 4. Extending the Test Suites

To add more tests to the conformance suite, you can modify the `run_rtl_conformance_fixed.sh` script. The script currently supports the I, M, and privilege extensions. To add a new extension, you would need to:

1.  Add a new command-line option to the script to enable the new extension.
2.  Add a new section to the script to generate the test list for the new extension.
3.  Ensure that the reference signatures for the new extension have been generated using the `generate_reference_signatures_fixed.sh` script.

For example, to add support for the 'C' (Compressed) extension, you would add a `--with-c` option and then add a new block to the script to add the 'C' extension tests to the `test_list.yaml` file.

